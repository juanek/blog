<!DOCTYPE html>
<html lang="es">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Juan E. Kipes Blog</title>


  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,600" rel="stylesheet" type="text/css">
  <!--<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600' rel='stylesheet' type='text/css'>-->
<link rel="stylesheet" href="/css/main.css">
   
    




 
</head>

  <body>
    <!-- NAV -->
<nav class="navbar navbar-expand-md navbar-light py-4">
  <div class="container">
    <a href="/" class="navbar-brand">
      <h2 class="d-inline align-middle pl-3 text-primary">Juan E. Kipes</h2>
    </a>
    <button class="navbar-toggler" data-toggle="collapse" data-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a href="/archivos/" class="nav-link">Archivos</a>
        </li>
        <li class="nav-item">
          <a href="/acerca/" class="nav-link">Sobre Mí</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

    <section id="banner" class="py-5 d-none d-sm-block">
  <div class="primary-overlay text-white">
    <div class="container">
      <div class="row">
        <div class="col-md-12 text-center">
          <!--<h1 class="display-5 pt-1">
	      ...un blog para compartir código...
      </h1>-->
      </div>
<!--      <div class="col-md-2"></div>-->
    </div>
  </div>
</section>

    <div id="post" class="container pt-3">
  <div class="row">
    <div class="col">
      <p class="lead text-info">
        Oct 13, 2018
        <span>&nbsp</span>
        <span>
        
          
          <a href="/tag/java"><code class="highligher-rouge"><nobr>#java</nobr></code></a>
        
          
          <a href="/tag/logback"><code class="highligher-rouge"><nobr>#logback</nobr></code></a>
        
          
          <a href="/tag/maven"><code class="highligher-rouge"><nobr>#maven</nobr></code></a>
        
      </span>
      </p>
      <h1><b><i>Agrega Logback a tu aplicación Java.</i></b></h1>
      <article>
        <div class="bs-callout bs-callout-success">
<h3>Contenido</h3>
<ul class="list-unstyled">
  <li><a href="#id-section1">1 - Introducción.</a></li>
  <li><a href="#id-section2">2 - Logger, Appenders y Layouts.</a></li>
  <li><a href="#id-section3">3 - Configuración.</a></li>
  <li><a href="#id-section4">4 - Ejemplo básico y configuración.</a></li>
  <li><a href="#id-section5">5- Logger contextos.</a></li>
  <li><a href="#id-section6">6 - Configuración detallada.</a></li>
  <li><a href="#id-section7">7 - Appenders.</a></li>
  <li><a href="#id-section8">8 - Layouts</a></li>
  <li><a href="#id-conclusiones">Conclusiones.</a></li>
  <li><a href="#id-referencias">Referencias.</a></li>
</ul>
</div>

<p>Una guía para Logback.</p>

<div id="id-section1" />

<h2 id="1---introducción">1 - Introducción</h2>

<p>Logback es uno de los frameworks de logging más populares en la comunidad Java, fue creado como sucesor del proyecto Log4j. Dado que el logging es una parte crucial de cualquier aplicación tanto para propósitos de debugger como de auditoría, elegir la adeucuada librería de logging es una decisión importante para cualquier proyecto.</p>

<p>¿Porqué elegir Logback?</p>

<ul>
  <li>Es más rápido que Log4j.</li>
  <li>Arquitectura modular.</li>
  <li>Fácil de integrar con sistemas legacy.</li>
  <li>Altamente configurable.</li>
</ul>

<p>Veremos la como está diseñado Logback y como usarlo para desarrollar mejores aplicaciones.</p>

<div id="id-section2" />

<h2 id="2---logger-appenders-y-layouts">2 - Logger, Appenders y Layouts</h2>

<p>Logback está desarrollado en torno a tres clases principales: <strong>Logger</strong>, <strong>Appender</strong> y <strong>Layout</strong>.</p>

<p><strong>Logger</strong> es un contexto para los mensajes de log. Esta es la clase que interactúa con las aplicaciónes para crear mensajes de log.</p>

<p>Los <strong>Appenders</strong> son los lugares a donde serán dirigidos los mensajes de log. Un Logger puede tener más de un Appender. Generalmente pensamos en los Appenders como la consola o archivos de textos, pero Logback es más potente que esto.</p>

<p>La clase <strong>Layout</strong> es la encargada de darle formato a la salida de los mensages de log. Logback soporta la creación de clases personalizadas para el formateo de los mensajes, así como también robustas opciones de configuración para las ya existentes.</p>

<div id="id-section3" />

<h2 id="3---dependencias">3 - Dependencias.</h2>

<p>Necesitamos crear un proyecto maven de ejemplo y agregar las dependencias.</p>

<p>Logback usa Simple Logging Facade para Java (SLF4J) como su interfaz nativa. Así que necesitamos agregar Logback y SLF4J a nuestro pom.xml</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>logback-classic<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.2.3<span class="nt">&lt;/version&gt;</span>
      <span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>slf4j-api<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.7.25<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure>

<p>Maven central tiene la última version de Logback core y la versión mas reciente de slfj-api.</p>

<div id="id-section4" />

<h2 id="4---ejemplo-básico">4 - Ejemplo básico.</h2>

<p>Vamos a comenzar con un ejemplo sencillo de usar Logback en una aplicación.
Primero necesitamos un archivo de configuración. Creamos un archivo de texto llamado logback.xml y lo ponemos en algún lugar en nuestro classpath, en este caso en <strong>/src/main/resources/logback.xml</strong></p>

<figure class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">├── pom.xml
├── README.md
├── src
│   ├── main
│   │   ├── java
│   │   │   └── ar
│   │   │       └── com
│   │   │           └── jekipes
│   │   │               ├── App.java
│   │   │               └── Simple.java
│   │   └── resources
│   │       └── logback.xml</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"STDOUT"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.ConsoleAppender"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;encoder&gt;</span>
      <span class="nt">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span class="nt">&lt;/pattern&gt;</span>
    <span class="nt">&lt;/encoder&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"INFO"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STDOUT"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/configuration&gt;</span></code></pre></figure>

<p>Además necesitamos una clase simple con un método main. Para registrar un mensaje de log con Logback, inicializamos un Logger desde SLF4J o Logback y lo usamos</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Simple</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">Simple</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="cm">/**
     * @param args the command line arguments
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Hello world from {}"</span><span class="o">,</span> <span class="n">Simple</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Ejecutamos nuestro programa</p>

<figure class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">$</span> mvn <span class="nb">exec</span>:java <span class="nt">-Dexec</span>.mainClass<span class="o">=</span><span class="s2">"ar.com.jekipes.Ejemplo"</span>
<span class="go">21:00:50.444 [ar.com.jekipes.Ejemplo.main()] INFO  ar.com.jekipes.Ejemplo - Un log de Ejemplo</span></code></pre></figure>

<p>Esta clase crea un Logger y llama al método info() para generar un mensaje de log.
Es fácil ver porque Logback es tan popular, podemos configurarlo y comenzar a usarlo en minutos.</p>

<p>Esta configuración y este código nos dá unas pocas pistas de como trabaja.</p>
<ul>
  <li>1 - Tenemos un appender llamado STDOUT que referencia a la clase ConsoleAppender.</li>
  <li>2 - Hay un tag <pattern> que describe el formato de nuestro mensaje de log.</pattern></li>
  <li>3 - Nuestro código crea un Logger y le pasamos nuestro mensaje vía el método info()</li>
</ul>

<p>Ahora que comprendemos lo básico , vamos a un análisis más detallado.</p>

<div id="id-section4" />

<h2 id="5--logger">5- Logger</h2>
<h3 id="51---niveles-de-logs">5.1 - Niveles de logs.</h3>

<p>Como vimos arriba en el archivo <strong>logback.xml</strong> podemos configurar el logger para mostrar mensajes de distintos tipos, trace, error, info, etc.  Estos son los niveles de logs que maneja logback.</p>
<div class="bs-callout bs-callout-info">
TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR
</div>

<p>En nuestro ejemplo, el root looger está configurado a nivel <code>INFO</code>, si cambiamos <code>logger.info()</code> por <code>logger.debug()</code> veremos que no imprime nada. y si volvemos a reemplazar <code>logger.debug()</code> por <code>logger.warn()</code> veremos que el logger registra mensajes de log.</p>
<div class="bs-callout bs-callout-success">
<b>REGLA: Cualquier logger con nivel X puede manejar mensajes de nivel Y, donde Y &gt;= X.</b>
</div>

<h3 id="52---jerarquías-de-logs">5.2 - Jerarquías de logs.</h3>
<p>Otro concepto importante de la configuración de logs es la jeraquía de los mismos. Para comprender mejor este concepto vamos a modificar nuestro <strong>logback.xml</strong> con el siguiente contenido</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"STDOUT"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.ConsoleAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>

    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"ar.com.jekipes"</span> <span class="na">level=</span><span class="s">"INFO"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STDOUT"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"INFO"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STDOUT"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/configuration&gt;</span></code></pre></figure>

<p>En la configuración de arriba tenemos dos logger, el logger <strong>root</strong> y el logger <strong>ar.com.jekipes</strong>. Agregamos el siguiente código y ejecutamos el programa.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HierarchyLogs</span> <span class="o">{</span>

    <span class="cm">/**
     * @param args the command line arguments
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">HierarchyLogs</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">());</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Hello world!!!"</span><span class="o">);</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">HierarchyLogs</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getPackage</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Hello world again!!"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>Este código nos imprimirá en consola</p>

<figure class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">08:13:55.231 [ar.com.jekipes.HierarchyLogs.main()] INFO  HierarchyLogs - Hello world!!!
08:13:55.234 [ar.com.jekipes.HierarchyLogs.main()] INFO  ar.com.jekipes - Hello world again!!
08:13:55.234 [ar.com.jekipes.HierarchyLogs.main()] INFO  ar.com.jekipes - Hello world again!!</span></code></pre></figure>

<p>Cuando logger.info() es llamado desde el looger <strong>root</strong> sólo una sentencia se imprime en cosnola pero cuando es invocado desde el logger <strong>ar.com.jekipes</strong> se imprime dos veces. Y esto se debe a la jerarquía de logs.</p>
<div class="bs-callout bs-callout-success">
Regla: La jerarquía de logs significa que un logger (X.Y) es automáticamnte considerado padre de todos los loggers nombrados (X.Y.*). Si el logger padre está definido en la configuración, cualquiera de los mensajes de log dirigidos al logger hijo también seran manejados por el logger padre.
</div>
<p>In our case, com.pawan.logger is parent logger of com.pawan.logger.test logger. When we tried to log via com.pawan.logger.test then as per log hierarchy rules, the parent level logger also handled the request &amp; logged the message. Once again go the official documentation here &amp; make sure that you clearly understand the concept of logger hierarchy.</p>

<h3 id="53---parametrizando-mensajes">5.3 - Parametrizando mensajes.</h3>
<div id="id-section6" />

<h2 id="6---configuración-detallada">6 - Configuración detallada.</h2>
<h3 id="61---ubicando-el-archivo-de-configuración">6.1 - Ubicando el archivo de configuración</h3>
<h3 id="62---configuración-básica">6.2 - Configuración básica.</h3>
<h3 id="63---solución-a-problemas-de-configuración">6.3 - Solución a problemas de configuración.</h3>
<h3 id="64---recarga-automática-de-la-configuración">6.4 - Recarga automática de la configuración.</h3>
<h3 id="65---modificando-loggers">6.5 - Modificando Loggers</h3>
<h3 id="66---sustitución-de-variables">6.6 - Sustitución de variables.</h3>
<div id="id-section7" />

<h2 id="7---appenders">7 - Appenders.</h2>
<h3 id="71---consoleappender">7.1 - ConsoleAppender.</h3>
<h3 id="72---fileappender">7.2 - FileAppender.</h3>
<h3 id="73---rollingfileappender">7.3 - RollingFileAppender.</h3>
<h3 id="74---personalizando-los-appenders">7.4 - Personalizando los Appenders</h3>
<div id="id-section8" />

<h2 id="8---layouts">8 - Layouts</h2>
<div id="id-conclusiones" />

<h2 id="conclusión">Conclusión.</h2>
<div id="id-referencias" />

<h2 id="referencias">Referencias</h2>

<p>1 - Introducción.</p>

<p>Logback es uno de los frameworks de logging más populares en la comunidad Java. Es un reemplazo para su antecesor Log4j. Logback ofrece una implementación más veloz que Log4j, provee más opciones de configuración y más flexibilidad para archivar arcivos de logging antiguos.
Esta introducción nos introducirá en la arquitectura de Logback y muestra como lo puedes usar para hacer mejores aplicaciones.</p>

      </article>
    </div>
  </div>
  
</div>

    <footer class="py-5">
  <hr>
  <div class="container text-center text-info">
    <div class="row">
      <div class="col">
        
          <div class="social-links">
  <a target="_blank" href="https://github.com/juanek">
    <i class="fab fa-github fa-2x"></i>
  </a>
  <a href="mailto:juanekipes@gmail.com">
    <i class="fa fa-envelope fa-2x" ></i>
  </a>
  <a target="_blank" href="https://ar.pinterest.com/jkipes">
    <i class="fab fa-pinterest fa-2x"></i>
  </a>
  <!--<a target="_blank" href="https://twitter.com/">
    <i class="fab fa-twitter fa-2x"></i>
  </a>-->
</div>

        
      </div>
    </div>
    <div class="row">
      <div class="col">
        Juan E. Kipes &copy; 2018.
      </div>
    </div>
  </div>
</footer>

<!-- JS -->
<script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js" integrity="sha384-SlE991lGASHoBfWbelyBPLsUlwY1GwNDJo3jSJO04KZ33K2bwfV9YBauFfnzvynJ" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
 <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.4.0/highlightjs-line-numbers.min.js"></script>
  <script type="text/javascript">
    hljs.initHighlightingOnLoad();
    //hljs.initLineNumbersOnLoad();
    hljs.initLineNumbersOnLoad({
    singleLine: true
});
 </script>

  </body>
</html>
